# å‰åç«¯é›†æˆè¯Šæ–­å·¥å…·

## æ¦‚è¿°

è¯Šæ–­å·¥å…· (`src/services/diagnostics.js`) ç”¨äºå¿«é€Ÿæ£€æŸ¥å’ŒéªŒè¯å‰åç«¯é›†æˆçš„é…ç½®çŠ¶æ€ã€‚

## å¦‚ä½•ä½¿ç”¨

### æ–¹å¼ 1ï¼šåœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ

1. æ‰“å¼€å‰ç«¯åº”ç”¨ (http://localhost:3000)
2. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…· (F12)
3. è¿›å…¥ Console æ ‡ç­¾é¡µ
4. å¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹ä»£ç ï¼š

```javascript
// å¯¼å…¥è¯Šæ–­å·¥å…·ï¼ˆå‡è®¾å·²åœ¨ä¸»æ–‡ä»¶ä¸­å¯¼å…¥ï¼‰
import diagnostics from './services/diagnostics';

// è¿è¡Œå®Œæ•´è¯Šæ–­æŠ¥å‘Š
diagnostics.quickTest();
```

æˆ–è€…åœ¨æ§åˆ¶å°ç›´æ¥æ‰§è¡Œï¼ˆå¦‚æœå·²å…¨å±€å¯¼å…¥ï¼‰ï¼š

```javascript
// æ£€æŸ¥ API é…ç½®
window.diagnostics.checkConfig();

// æ£€æŸ¥æ¨¡æ‹Ÿæ•°æ®
window.diagnostics.checkMockData();

// æµ‹è¯•åç«¯è¿æ¥
window.diagnostics.testConnection();

// ç”Ÿæˆå®Œæ•´æŠ¥å‘Š
window.diagnostics.generateReport();
```

### æ–¹å¼ 2ï¼šåœ¨ä»£ç ä¸­è°ƒç”¨

åœ¨ä»»ä½• React ç»„ä»¶ä¸­ï¼š

```javascript
import diagnostics from '../services/diagnostics';

function TestComponent() {
  useEffect(() => {
    diagnostics.quickTest();
  }, []);
  
  return <div>æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°æŸ¥çœ‹è¯Šæ–­ç»“æœ</div>;
}
```

## è¯Šæ–­åŠŸèƒ½

### 1. `checkConfig()` - æ£€æŸ¥ API é…ç½®

æ˜¾ç¤ºå½“å‰çš„ API é…ç½®ä¿¡æ¯ï¼š
- åç«¯åŸºç¡€ URL
- API è¶…æ—¶æ—¶é—´
- æ˜¯å¦ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
========== API é…ç½®æ£€æŸ¥ ==========
åç«¯åŸºç¡€ URL: http://localhost:8080/javaweb
API è¶…æ—¶: 10000 ms
ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®: false
===================================
```

### 2. `checkMockData()` - æ£€æŸ¥æ¨¡æ‹Ÿæ•°æ®

éªŒè¯æœ¬åœ°æ¨¡æ‹Ÿæ•°æ®æ˜¯å¦æ­£ç¡®åŠ è½½ï¼š
- å……ç”µç«™æ€»æ•°
- ç¬¬ä¸€ä¸ªå……ç”µç«™çš„è¯¦ç»†ä¿¡æ¯

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
========== æ¨¡æ‹Ÿæ•°æ®æ£€æŸ¥ ==========
å……ç”µç«™æ•°é‡: 5
ç¬¬ä¸€ä¸ªå……ç”µç«™: {id: 1, location: 'æœé˜³é—¨', ...}
===================================
```

### 3. `testConnection()` - æµ‹è¯•åç«¯è¿æ¥

æµ‹è¯•å‰ç«¯æ˜¯å¦èƒ½æˆåŠŸè¿æ¥åˆ°åç«¯ APIï¼š

**æˆåŠŸå“åº”**ï¼š
```
========== åç«¯è¿æ¥æµ‹è¯• ==========
æ­£åœ¨æµ‹è¯•: http://localhost:8080/javaweb/api/stations
âœ… è¿æ¥æˆåŠŸï¼
å“åº”æ•°æ®: [{...}, {...}, ...]
===================================
```

**å¤±è´¥å“åº”**ï¼š
```
========== åç«¯è¿æ¥æµ‹è¯• ==========
æ­£åœ¨æµ‹è¯•: http://localhost:8080/javaweb/api/stations
âŒ è¿æ¥å¤±è´¥ï¼
é”™è¯¯è¯¦æƒ…: Network Error
===================================
```

### 4. `testCors()` - æµ‹è¯• CORS é…ç½®

æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦æ­£ç¡®é…ç½®äº† CORS å¤´ï¼š

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
========== CORS æµ‹è¯• ==========
âœ… CORS æ£€æŸ¥å®Œæˆï¼
CORS å¤´ä¿¡æ¯: {
  Access-Control-Allow-Origin: "*",
  Access-Control-Allow-Methods: "GET, POST, PUT, DELETE, OPTIONS",
  Access-Control-Allow-Headers: "Content-Type, Authorization"
}
==============================
```

### 5. `testEndpoints()` - æµ‹è¯•æ‰€æœ‰ API ç«¯ç‚¹

é€ä¸ªæµ‹è¯•æ‰€æœ‰å…³é”® API ç«¯ç‚¹ï¼š
- `/api/stations` - è·å–æ‰€æœ‰å……ç”µç«™
- `/api/stations/{id}` - è·å–å•ä¸ªå……ç”µç«™
- `/api/stations/nearby` - è·å–é™„è¿‘å……ç”µç«™

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
========== API ç«¯ç‚¹æµ‹è¯• ==========
æµ‹è¯•: /api/stations
âœ… è·å–æ‰€æœ‰å……ç”µç«™: 5 ä¸ª
æµ‹è¯•: /api/stations/1
âœ… è·å–å•ä¸ªå……ç”µç«™: æœé˜³é—¨
æµ‹è¯•: /api/stations/nearby
âœ… è·å–é™„è¿‘å……ç”µç«™: 3 ä¸ª
==================================
```

### 6. `generateReport()` - ç”Ÿæˆå®Œæ•´è¯Šæ–­æŠ¥å‘Š

ç”ŸæˆåŒ…å«æ‰€æœ‰è¯Šæ–­ä¿¡æ¯çš„å®Œæ•´æŠ¥å‘Šï¼š

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   å‰åç«¯é›†æˆè¯Šæ–­æŠ¥å‘Š                       â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ç”Ÿæˆæ—¶é—´: 2025/12/10 10:30:45

ğŸ“¦ å½“å‰æ¨¡å¼: ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®
âœ… æ¨¡æ‹Ÿæ•°æ®çŠ¶æ€: æ­£å¸¸ï¼ˆ5 ä¸ªå……ç”µç«™ï¼‰

ğŸ’¡ æç¤º: å¦‚éœ€æµ‹è¯•çœŸå® APIï¼Œè¯·åœ¨ config/api.config.js ä¸­è®¾ç½® useMockData: false

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘            è¯Šæ–­æ€»ç»“                        â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### 7. `quickTest()` - å¿«é€Ÿæµ‹è¯•

è¿è¡Œæ‰€æœ‰è¯Šæ–­åŠŸèƒ½ï¼Œç”Ÿæˆå®Œæ•´æŠ¥å‘Šï¼ˆæ¨èä½¿ç”¨ï¼‰ã€‚

## å¿«é€Ÿè¯Šæ–­åœºæ™¯

### åœºæ™¯ 1ï¼šå‰ç«¯ä¸èƒ½å¯åŠ¨

**ç—‡çŠ¶**ï¼šnpm start å‡ºé”™

**è¯Šæ–­æ­¥éª¤**ï¼š
```bash
# 1. æ£€æŸ¥ Node.js ç‰ˆæœ¬
node --version

# 2. åˆ é™¤å¹¶é‡æ–°å®‰è£…ä¾èµ–
rm -rf node_modules package-lock.json
npm install

# 3. æ¸…ç† npm ç¼“å­˜
npm cache clean --force

# 4. é‡æ–°å¯åŠ¨
npm start
```

### åœºæ™¯ 2ï¼šé¡µé¢åŠ è½½ä½†æ²¡æœ‰æ•°æ®

**ç—‡çŠ¶**ï¼šåœ°å›¾æ˜¾ç¤ºä½†æ²¡æœ‰å……ç”µç«™æ ‡è®°

**è¯Šæ–­æ­¥éª¤**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
import diagnostics from './services/diagnostics';

// 1. æ£€æŸ¥é…ç½®
diagnostics.checkConfig();

// 2. æ£€æŸ¥æ¨¡æ‹Ÿæ•°æ®
diagnostics.checkMockData();

// 3. å¦‚æœä½¿ç”¨çœŸå® APIï¼Œæµ‹è¯•è¿æ¥
diagnostics.testConnection();
```

### åœºæ™¯ 3ï¼šCORS é”™è¯¯

**ç—‡çŠ¶**ï¼šæ§åˆ¶å°å‡ºç° "Access to XMLHttpRequest blocked by CORS policy"

**è¯Šæ–­æ­¥éª¤**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°è¿è¡Œ
import diagnostics from './services/diagnostics';

// æµ‹è¯• CORS
diagnostics.testCors();

// æµ‹è¯•æ‰€æœ‰ç«¯ç‚¹
diagnostics.testEndpoints();
```

### åœºæ™¯ 4ï¼šAPI è¿”å› 404

**ç—‡çŠ¶**ï¼šåç«¯è¿æ¥æ—¶å‡ºç° 404 é”™è¯¯

**è¯Šæ–­æ­¥éª¤**ï¼š
```javascript
// 1. ç¡®è®¤åç«¯ URL
diagnostics.checkConfig();  // æ£€æŸ¥ baseURL

// 2. åœ¨æµè§ˆå™¨åœ°å€æ ç›´æ¥è®¿é—®
// http://localhost:8080/javaweb/api/stations

// 3. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
// åœ¨åç«¯æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹æ—¥å¿—
```

## å¸¸è§é”™è¯¯å’Œè§£å†³æ–¹æ¡ˆ

### "Cannot find module" é”™è¯¯

**åŸå› **ï¼šä¾èµ–æœªå®‰è£…æˆ–ç‰ˆæœ¬ä¸åŒ¹é…

**è§£å†³**ï¼š
```bash
npm install
npm audit fix  # ä¿®å¤å®‰å…¨æ¼æ´
```

### "Network Error"

**åŸå› **ï¼šåç«¯æœªè¿è¡Œæˆ– URL ä¸æ­£ç¡®

**è§£å†³**ï¼š
```javascript
// 1. æ£€æŸ¥ URL
diagnostics.checkConfig();

// 2. æ£€æŸ¥åç«¯æ˜¯å¦è¿è¡Œ
// è®¿é—® http://localhost:8080/javaweb

// 3. å¦‚æœéœ€è¦ï¼Œä¿®æ”¹ src/config/api.config.js
```

### "CORS policy blocked"

**åŸå› **ï¼šåç«¯æœªé…ç½® CORS

**è§£å†³**ï¼š
```javascript
// ç¡®ä¿åç«¯æ·»åŠ äº† CorsFilter.java
diagnostics.testCors();

// ä¹Ÿå¯ä»¥ä¸´æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®ç»•è¿‡
// åœ¨ src/config/api.config.js ä¸­è®¾ç½® useMockData: true
```

### "useMockData is undefined"

**åŸå› **ï¼šé…ç½®æ–‡ä»¶æœªæ­£ç¡®å¯¼å…¥

**è§£å†³**ï¼š
```javascript
// æ£€æŸ¥ src/services/stationService.js
// ç¡®ä¿æ­£ç¡®å¯¼å…¥äº†é…ç½®
import { API_CONFIG } from '../config/api.config';
```

## å¯¼å‡ºè¯Šæ–­ç»“æœ

è¯Šæ–­ç»“æœä¼šè‡ªåŠ¨è¾“å‡ºåˆ°æµè§ˆå™¨æ§åˆ¶å°ã€‚ä½ å¯ä»¥ï¼š

1. **å¤åˆ¶æ§åˆ¶å°è¾“å‡º**ï¼šå³é”® â†’ ä¿å­˜ä¸ºæ–‡ä»¶
2. **æˆªå›¾**ï¼šç”¨æˆªå›¾å·¥å…·è®°å½•è¯Šæ–­ç»“æœ
3. **å¯¼å‡ºä¸º JSON**ï¼šä¿®æ”¹è¯Šæ–­å·¥å…·ä»¥è¾“å‡º JSON æ ¼å¼

## è¿›é˜¶ä½¿ç”¨

### åˆ›å»ºè‡ªå®šä¹‰è¯Šæ–­

```javascript
import diagnostics from '../services/diagnostics';

export const customDiagnostic = async () => {
  // è¿è¡Œæ‰€æœ‰è¯Šæ–­
  await diagnostics.generateReport();
  
  // æ·»åŠ è‡ªå®šä¹‰æ£€æŸ¥
  console.log('ğŸ” è‡ªå®šä¹‰æ£€æŸ¥...');
  // ä½ çš„æ£€æŸ¥ä»£ç 
};
```

### ä¸æµ‹è¯•æ¡†æ¶é›†æˆ

```javascript
import { render } from '@testing-library/react';
import diagnostics from '../services/diagnostics';

test('åº”ç”¨é…ç½®æ­£ç¡®', () => {
  const config = diagnostics.checkConfig();
  expect(config.baseURL).toBeDefined();
  expect(config.timeout).toBeGreaterThan(0);
});
```

## åé¦ˆå’Œæ”¹è¿›

å¦‚æœ‰è¯Šæ–­å·¥å…·çš„æ”¹è¿›å»ºè®®ï¼Œè¯·æäº¤ issue æˆ– PRã€‚

è¯Šæ–­å·¥å…·æºä»£ç ï¼š`src/services/diagnostics.js`
